#!/bin/bash -e

if [ -n "${HOLOLENS_HELM_NAMESPACE}" ]; then
    _helm_args="${_helm_args} --namespace ${HOLOLENS_HELM_NAMESPACE}"
fi

if [ -n "${HOLOLENS_HELM_RELEASE_NAME}" ]; then
    _helm_args="${_helm_args} --release-name ${HOLOLENS_HELM_RELEASE_NAME}"
fi

for _value_file in ${HOLOLENS_HELM_VALUE_FILES//,/ }; do
    _helm_args="${_helm_args} --values ${_value_file}"
done

echo "executing: helm template ${_helm_args}"
helm template \
    ${_helm_args} \
    "${HOLOLENS_HELM_CHART_PATH:-.}" \
    > "${OUTPUT_PATH}"
